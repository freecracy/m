<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>分库分表 | 嗯哼人生</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    <meta name="referrer" content="no-referrer">
    
    <link rel="preload" href="/m/assets/css/0.styles.1e386fb6.css" as="style"><link rel="preload" href="/m/assets/js/app.71fdaff2.js" as="script"><link rel="preload" href="/m/assets/js/2.351ead77.js" as="script"><link rel="preload" href="/m/assets/js/4.b9f14f77.js" as="script"><link rel="prefetch" href="/m/assets/js/10.98c1e7e0.js"><link rel="prefetch" href="/m/assets/js/100.d7774ae1.js"><link rel="prefetch" href="/m/assets/js/101.0d4dea0d.js"><link rel="prefetch" href="/m/assets/js/102.6867f859.js"><link rel="prefetch" href="/m/assets/js/103.9d24bd08.js"><link rel="prefetch" href="/m/assets/js/104.4d59f256.js"><link rel="prefetch" href="/m/assets/js/105.ff49af8e.js"><link rel="prefetch" href="/m/assets/js/106.b26c7611.js"><link rel="prefetch" href="/m/assets/js/107.da5be320.js"><link rel="prefetch" href="/m/assets/js/108.0c03f842.js"><link rel="prefetch" href="/m/assets/js/109.5587de24.js"><link rel="prefetch" href="/m/assets/js/11.4e6d88d4.js"><link rel="prefetch" href="/m/assets/js/110.40ae6022.js"><link rel="prefetch" href="/m/assets/js/111.0353ccf3.js"><link rel="prefetch" href="/m/assets/js/112.f562c096.js"><link rel="prefetch" href="/m/assets/js/113.7926c003.js"><link rel="prefetch" href="/m/assets/js/114.356035f0.js"><link rel="prefetch" href="/m/assets/js/115.15e5e23e.js"><link rel="prefetch" href="/m/assets/js/116.2db2b1ed.js"><link rel="prefetch" href="/m/assets/js/117.2658e42c.js"><link rel="prefetch" href="/m/assets/js/118.037a8503.js"><link rel="prefetch" href="/m/assets/js/119.21153540.js"><link rel="prefetch" href="/m/assets/js/12.c3dadd73.js"><link rel="prefetch" href="/m/assets/js/120.b8f0644f.js"><link rel="prefetch" href="/m/assets/js/121.4c1c263a.js"><link rel="prefetch" href="/m/assets/js/122.d6ba18dd.js"><link rel="prefetch" href="/m/assets/js/123.ceef4883.js"><link rel="prefetch" href="/m/assets/js/124.9e5f50ca.js"><link rel="prefetch" href="/m/assets/js/125.de1ddc80.js"><link rel="prefetch" href="/m/assets/js/126.ae350aea.js"><link rel="prefetch" href="/m/assets/js/127.4636f6be.js"><link rel="prefetch" href="/m/assets/js/128.13b379ab.js"><link rel="prefetch" href="/m/assets/js/129.e7b0a15f.js"><link rel="prefetch" href="/m/assets/js/13.a52bd89b.js"><link rel="prefetch" href="/m/assets/js/130.147cdf11.js"><link rel="prefetch" href="/m/assets/js/131.c7a07871.js"><link rel="prefetch" href="/m/assets/js/132.faf72eb9.js"><link rel="prefetch" href="/m/assets/js/133.6301923b.js"><link rel="prefetch" href="/m/assets/js/134.4357c6e4.js"><link rel="prefetch" href="/m/assets/js/135.0ea43a3d.js"><link rel="prefetch" href="/m/assets/js/136.5a7c2377.js"><link rel="prefetch" href="/m/assets/js/137.393c998e.js"><link rel="prefetch" href="/m/assets/js/138.dcf958b6.js"><link rel="prefetch" href="/m/assets/js/139.1ccac68b.js"><link rel="prefetch" href="/m/assets/js/14.96fff293.js"><link rel="prefetch" href="/m/assets/js/140.938c314e.js"><link rel="prefetch" href="/m/assets/js/141.03cc2137.js"><link rel="prefetch" href="/m/assets/js/142.db00aba9.js"><link rel="prefetch" href="/m/assets/js/143.6d7b22af.js"><link rel="prefetch" href="/m/assets/js/144.850ed5a9.js"><link rel="prefetch" href="/m/assets/js/145.a1958a5f.js"><link rel="prefetch" href="/m/assets/js/146.1b350d4f.js"><link rel="prefetch" href="/m/assets/js/147.961f3ccd.js"><link rel="prefetch" href="/m/assets/js/148.cb4f8811.js"><link rel="prefetch" href="/m/assets/js/149.45ad7c2c.js"><link rel="prefetch" href="/m/assets/js/15.c507965f.js"><link rel="prefetch" href="/m/assets/js/150.5d952b70.js"><link rel="prefetch" href="/m/assets/js/151.5c794bb0.js"><link rel="prefetch" href="/m/assets/js/152.974e657e.js"><link rel="prefetch" href="/m/assets/js/153.b7cf98f6.js"><link rel="prefetch" href="/m/assets/js/154.be904394.js"><link rel="prefetch" href="/m/assets/js/155.769e3b0d.js"><link rel="prefetch" href="/m/assets/js/156.6107a44f.js"><link rel="prefetch" href="/m/assets/js/157.0bf74a2b.js"><link rel="prefetch" href="/m/assets/js/158.d499f907.js"><link rel="prefetch" href="/m/assets/js/159.6b2acd2c.js"><link rel="prefetch" href="/m/assets/js/16.247520d0.js"><link rel="prefetch" href="/m/assets/js/160.ec909209.js"><link rel="prefetch" href="/m/assets/js/161.4832768d.js"><link rel="prefetch" href="/m/assets/js/162.ae74834a.js"><link rel="prefetch" href="/m/assets/js/163.8af51be9.js"><link rel="prefetch" href="/m/assets/js/164.0d64a1ef.js"><link rel="prefetch" href="/m/assets/js/165.5e5a775c.js"><link rel="prefetch" href="/m/assets/js/166.121987f8.js"><link rel="prefetch" href="/m/assets/js/167.1c270942.js"><link rel="prefetch" href="/m/assets/js/168.200df8c8.js"><link rel="prefetch" href="/m/assets/js/169.84f5e0d7.js"><link rel="prefetch" href="/m/assets/js/17.3cb462b5.js"><link rel="prefetch" href="/m/assets/js/170.57b7eec5.js"><link rel="prefetch" href="/m/assets/js/171.d993d636.js"><link rel="prefetch" href="/m/assets/js/172.820d00a1.js"><link rel="prefetch" href="/m/assets/js/173.cc29ff6e.js"><link rel="prefetch" href="/m/assets/js/174.99d62af7.js"><link rel="prefetch" href="/m/assets/js/175.da874148.js"><link rel="prefetch" href="/m/assets/js/176.d0755bfc.js"><link rel="prefetch" href="/m/assets/js/177.8b00d874.js"><link rel="prefetch" href="/m/assets/js/178.2b0cfda8.js"><link rel="prefetch" href="/m/assets/js/179.780a3873.js"><link rel="prefetch" href="/m/assets/js/18.298da910.js"><link rel="prefetch" href="/m/assets/js/180.7c0ac3dc.js"><link rel="prefetch" href="/m/assets/js/181.507f9073.js"><link rel="prefetch" href="/m/assets/js/182.87f76d4a.js"><link rel="prefetch" href="/m/assets/js/183.1410502e.js"><link rel="prefetch" href="/m/assets/js/184.80666cb3.js"><link rel="prefetch" href="/m/assets/js/185.dc628b97.js"><link rel="prefetch" href="/m/assets/js/186.c2560a3f.js"><link rel="prefetch" href="/m/assets/js/187.6af43ea3.js"><link rel="prefetch" href="/m/assets/js/188.da75b50c.js"><link rel="prefetch" href="/m/assets/js/189.78dd960b.js"><link rel="prefetch" href="/m/assets/js/19.d9eabdf8.js"><link rel="prefetch" href="/m/assets/js/190.017586b9.js"><link rel="prefetch" href="/m/assets/js/191.5fa65eb7.js"><link rel="prefetch" href="/m/assets/js/192.5bb628c7.js"><link rel="prefetch" href="/m/assets/js/193.35707c80.js"><link rel="prefetch" href="/m/assets/js/194.35c3b13b.js"><link rel="prefetch" href="/m/assets/js/195.6dc8874b.js"><link rel="prefetch" href="/m/assets/js/196.01a1e825.js"><link rel="prefetch" href="/m/assets/js/197.5745084a.js"><link rel="prefetch" href="/m/assets/js/198.0455ca12.js"><link rel="prefetch" href="/m/assets/js/199.75129c13.js"><link rel="prefetch" href="/m/assets/js/20.ce14ddb9.js"><link rel="prefetch" href="/m/assets/js/200.a08681d0.js"><link rel="prefetch" href="/m/assets/js/201.a54018b7.js"><link rel="prefetch" href="/m/assets/js/202.2361e839.js"><link rel="prefetch" href="/m/assets/js/203.b92491ee.js"><link rel="prefetch" href="/m/assets/js/204.13742571.js"><link rel="prefetch" href="/m/assets/js/205.b066e447.js"><link rel="prefetch" href="/m/assets/js/206.e2c72f2c.js"><link rel="prefetch" href="/m/assets/js/207.09a83a9a.js"><link rel="prefetch" href="/m/assets/js/208.f4b8d71c.js"><link rel="prefetch" href="/m/assets/js/209.1a4e4d18.js"><link rel="prefetch" href="/m/assets/js/21.0dc0e0bf.js"><link rel="prefetch" href="/m/assets/js/210.9709d46f.js"><link rel="prefetch" href="/m/assets/js/211.3704916b.js"><link rel="prefetch" href="/m/assets/js/212.7c96c99f.js"><link rel="prefetch" href="/m/assets/js/213.b4aedaa1.js"><link rel="prefetch" href="/m/assets/js/214.d0b2586b.js"><link rel="prefetch" href="/m/assets/js/215.2268650a.js"><link rel="prefetch" href="/m/assets/js/216.dcaa6f2f.js"><link rel="prefetch" href="/m/assets/js/217.33aaf649.js"><link rel="prefetch" href="/m/assets/js/218.216d8592.js"><link rel="prefetch" href="/m/assets/js/219.44d35873.js"><link rel="prefetch" href="/m/assets/js/22.ce355d8a.js"><link rel="prefetch" href="/m/assets/js/220.ff06fa11.js"><link rel="prefetch" href="/m/assets/js/221.93379b76.js"><link rel="prefetch" href="/m/assets/js/222.6f0bbeea.js"><link rel="prefetch" href="/m/assets/js/223.4c5e29f0.js"><link rel="prefetch" href="/m/assets/js/224.e7be32e4.js"><link rel="prefetch" href="/m/assets/js/225.4915db8f.js"><link rel="prefetch" href="/m/assets/js/226.60f21d11.js"><link rel="prefetch" href="/m/assets/js/227.0e63cf34.js"><link rel="prefetch" href="/m/assets/js/228.e7b7a543.js"><link rel="prefetch" href="/m/assets/js/229.73bf392a.js"><link rel="prefetch" href="/m/assets/js/23.40c917ac.js"><link rel="prefetch" href="/m/assets/js/230.9f789c55.js"><link rel="prefetch" href="/m/assets/js/231.8fd85bc2.js"><link rel="prefetch" href="/m/assets/js/232.e6c4a62c.js"><link rel="prefetch" href="/m/assets/js/233.45636bf3.js"><link rel="prefetch" href="/m/assets/js/234.5194ce16.js"><link rel="prefetch" href="/m/assets/js/235.15ba019b.js"><link rel="prefetch" href="/m/assets/js/236.ac5768c1.js"><link rel="prefetch" href="/m/assets/js/237.91ec2e5a.js"><link rel="prefetch" href="/m/assets/js/238.af630344.js"><link rel="prefetch" href="/m/assets/js/239.b2b84093.js"><link rel="prefetch" href="/m/assets/js/24.5b681006.js"><link rel="prefetch" href="/m/assets/js/240.9c9b1fba.js"><link rel="prefetch" href="/m/assets/js/241.c26c2147.js"><link rel="prefetch" href="/m/assets/js/242.ce44f37f.js"><link rel="prefetch" href="/m/assets/js/243.aa04b829.js"><link rel="prefetch" href="/m/assets/js/244.ee4c9090.js"><link rel="prefetch" href="/m/assets/js/245.62ebda1d.js"><link rel="prefetch" href="/m/assets/js/246.2fd9ce22.js"><link rel="prefetch" href="/m/assets/js/247.52b3e746.js"><link rel="prefetch" href="/m/assets/js/248.2e432a32.js"><link rel="prefetch" href="/m/assets/js/249.4598fccb.js"><link rel="prefetch" href="/m/assets/js/25.d5d6ba55.js"><link rel="prefetch" href="/m/assets/js/250.7c93bc3e.js"><link rel="prefetch" href="/m/assets/js/251.4d402930.js"><link rel="prefetch" href="/m/assets/js/252.1b3fb775.js"><link rel="prefetch" href="/m/assets/js/253.01a9b4f8.js"><link rel="prefetch" href="/m/assets/js/254.29de4256.js"><link rel="prefetch" href="/m/assets/js/255.4911ce12.js"><link rel="prefetch" href="/m/assets/js/256.0a40f8d2.js"><link rel="prefetch" href="/m/assets/js/257.2111ae5e.js"><link rel="prefetch" href="/m/assets/js/258.0e9b2cd1.js"><link rel="prefetch" href="/m/assets/js/259.43158d35.js"><link rel="prefetch" href="/m/assets/js/26.b1e00e8a.js"><link rel="prefetch" href="/m/assets/js/260.72ea8c45.js"><link rel="prefetch" href="/m/assets/js/261.3f679643.js"><link rel="prefetch" href="/m/assets/js/262.d9ecaed6.js"><link rel="prefetch" href="/m/assets/js/27.556976c4.js"><link rel="prefetch" href="/m/assets/js/28.11027d56.js"><link rel="prefetch" href="/m/assets/js/29.f40ac6f5.js"><link rel="prefetch" href="/m/assets/js/3.a2a1a8e5.js"><link rel="prefetch" href="/m/assets/js/30.3b59bb10.js"><link rel="prefetch" href="/m/assets/js/31.c37142be.js"><link rel="prefetch" href="/m/assets/js/32.c5e0d2a0.js"><link rel="prefetch" href="/m/assets/js/33.4f5f3a8d.js"><link rel="prefetch" href="/m/assets/js/34.4a3a9398.js"><link rel="prefetch" href="/m/assets/js/35.77f89f97.js"><link rel="prefetch" href="/m/assets/js/36.6ea00d3c.js"><link rel="prefetch" href="/m/assets/js/37.b5a3b5b4.js"><link rel="prefetch" href="/m/assets/js/38.24b26621.js"><link rel="prefetch" href="/m/assets/js/39.ab372876.js"><link rel="prefetch" href="/m/assets/js/40.7a81caac.js"><link rel="prefetch" href="/m/assets/js/41.d23cf8c8.js"><link rel="prefetch" href="/m/assets/js/42.ef938986.js"><link rel="prefetch" href="/m/assets/js/43.708a3cf3.js"><link rel="prefetch" href="/m/assets/js/44.f705f7de.js"><link rel="prefetch" href="/m/assets/js/45.0e6afdb6.js"><link rel="prefetch" href="/m/assets/js/46.9815c7cc.js"><link rel="prefetch" href="/m/assets/js/47.5d1c1dcc.js"><link rel="prefetch" href="/m/assets/js/48.d9d571a6.js"><link rel="prefetch" href="/m/assets/js/49.9cbaa1e9.js"><link rel="prefetch" href="/m/assets/js/5.57dbdc35.js"><link rel="prefetch" href="/m/assets/js/50.265f94f4.js"><link rel="prefetch" href="/m/assets/js/51.094b2e7f.js"><link rel="prefetch" href="/m/assets/js/52.8b7101c0.js"><link rel="prefetch" href="/m/assets/js/53.98f3fc0b.js"><link rel="prefetch" href="/m/assets/js/54.b3d830fd.js"><link rel="prefetch" href="/m/assets/js/55.fb9cd8c7.js"><link rel="prefetch" href="/m/assets/js/56.878cf94b.js"><link rel="prefetch" href="/m/assets/js/57.1c819831.js"><link rel="prefetch" href="/m/assets/js/58.ac3faf70.js"><link rel="prefetch" href="/m/assets/js/59.b0483bf9.js"><link rel="prefetch" href="/m/assets/js/6.a0c51186.js"><link rel="prefetch" href="/m/assets/js/60.48c301e6.js"><link rel="prefetch" href="/m/assets/js/61.4bf4f2e7.js"><link rel="prefetch" href="/m/assets/js/62.d927584b.js"><link rel="prefetch" href="/m/assets/js/63.b72a48f3.js"><link rel="prefetch" href="/m/assets/js/64.6923d7c8.js"><link rel="prefetch" href="/m/assets/js/65.042fc335.js"><link rel="prefetch" href="/m/assets/js/66.1afdb278.js"><link rel="prefetch" href="/m/assets/js/67.04f7b0c7.js"><link rel="prefetch" href="/m/assets/js/68.97789db4.js"><link rel="prefetch" href="/m/assets/js/69.d914e9f8.js"><link rel="prefetch" href="/m/assets/js/7.aef5e50f.js"><link rel="prefetch" href="/m/assets/js/70.84845956.js"><link rel="prefetch" href="/m/assets/js/71.d6e9132a.js"><link rel="prefetch" href="/m/assets/js/72.2c1f5783.js"><link rel="prefetch" href="/m/assets/js/73.789e9372.js"><link rel="prefetch" href="/m/assets/js/74.e79f4842.js"><link rel="prefetch" href="/m/assets/js/75.4a389066.js"><link rel="prefetch" href="/m/assets/js/76.f5721f28.js"><link rel="prefetch" href="/m/assets/js/77.e6ce992d.js"><link rel="prefetch" href="/m/assets/js/78.5c31237a.js"><link rel="prefetch" href="/m/assets/js/79.6a4f09e0.js"><link rel="prefetch" href="/m/assets/js/8.aac4a85a.js"><link rel="prefetch" href="/m/assets/js/80.23b925ca.js"><link rel="prefetch" href="/m/assets/js/81.bc8138cb.js"><link rel="prefetch" href="/m/assets/js/82.4783bc83.js"><link rel="prefetch" href="/m/assets/js/83.1be8f057.js"><link rel="prefetch" href="/m/assets/js/84.3132660e.js"><link rel="prefetch" href="/m/assets/js/85.95c5ab8b.js"><link rel="prefetch" href="/m/assets/js/86.17c9a201.js"><link rel="prefetch" href="/m/assets/js/87.daa0da6b.js"><link rel="prefetch" href="/m/assets/js/88.9409cacc.js"><link rel="prefetch" href="/m/assets/js/89.bf04eaa0.js"><link rel="prefetch" href="/m/assets/js/9.0dd0ff11.js"><link rel="prefetch" href="/m/assets/js/90.5e1e2630.js"><link rel="prefetch" href="/m/assets/js/91.6466b581.js"><link rel="prefetch" href="/m/assets/js/92.0dd7ffc6.js"><link rel="prefetch" href="/m/assets/js/93.045047c7.js"><link rel="prefetch" href="/m/assets/js/94.ce06dedb.js"><link rel="prefetch" href="/m/assets/js/95.f673ef28.js"><link rel="prefetch" href="/m/assets/js/96.1f73d13d.js"><link rel="prefetch" href="/m/assets/js/97.b1800fdc.js"><link rel="prefetch" href="/m/assets/js/98.245eb5e4.js"><link rel="prefetch" href="/m/assets/js/99.2cfc78a1.js">
    <link rel="stylesheet" href="/m/assets/css/0.styles.1e386fb6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/m/" class="home-link router-link-active"><!----> <span class="site-name">嗯哼人生</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/m/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="https://cn100800.tk" target="_blank" rel="noopener noreferrer" class="nav-link external">
  主站
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="mailto:freecracy1024@gmail.com" class="nav-link external">
  mail
  <!----></a></div><div class="nav-item"><a href="https://google.com.hk" target="_blank" rel="noopener noreferrer" class="nav-link external">
  google
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/m/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="https://cn100800.tk" target="_blank" rel="noopener noreferrer" class="nav-link external">
  主站
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="mailto:freecracy1024@gmail.com" class="nav-link external">
  mail
  <!----></a></div><div class="nav-item"><a href="https://google.com.hk" target="_blank" rel="noopener noreferrer" class="nav-link external">
  google
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Go语言之旅</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Deno</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其他</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>周末闲谈</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>深度好文</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>漫步 Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>设计模式</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/m/设计模式/分库分表.html" class="active sidebar-link">分库分表</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/m/设计模式/分库分表.html#部署" class="sidebar-link">部署</a></li><li class="sidebar-sub-header"><a href="/m/设计模式/分库分表.html#单个非主键查询" class="sidebar-link">单个非主键查询</a></li><li class="sidebar-sub-header"><a href="/m/设计模式/分库分表.html#多个非主键查询" class="sidebar-link">多个非主键查询</a></li><li class="sidebar-sub-header"><a href="/m/设计模式/分库分表.html#其他聚合查询" class="sidebar-link">其他聚合查询</a></li><li class="sidebar-sub-header"><a href="/m/设计模式/分库分表.html#跨库跨表分页查询" class="sidebar-link">跨库跨表分页查询</a></li><li class="sidebar-sub-header"><a href="/m/设计模式/分库分表.html#水平扩容" class="sidebar-link">水平扩容</a></li><li class="sidebar-sub-header"><a href="/m/设计模式/分库分表.html#分库分表问题" class="sidebar-link">分库分表问题</a></li><li class="sidebar-sub-header"><a href="/m/设计模式/分库分表.html#分库分表工具" class="sidebar-link">分库分表工具</a></li><li class="sidebar-sub-header"><a href="/m/设计模式/分库分表.html#主键" class="sidebar-link">主键</a></li></ul></li><li><a href="/m/设计模式/ES.html" class="sidebar-link">ES</a></li><li><a href="/m/设计模式/多账号登录.html" class="sidebar-link">多账户统一登录</a></li><li><a href="/m/设计模式/IM.html" class="sidebar-link">IM即时通信</a></li><li><a href="/m/设计模式/GraphQL.html" class="sidebar-link">GraphQL</a></li><li><a href="/m/设计模式/常用命令.html" class="sidebar-link">常用命令</a></li><li><a href="/m/设计模式/OAuth2.html" class="sidebar-link">OAuth2.0</a></li><li><a href="/m/设计模式/IO模型.html" class="sidebar-link">IO模型</a></li><li><a href="/m/设计模式/MySQL.html" class="sidebar-link">MySQL</a></li><li><a href="/m/设计模式/搜索引擎.html" class="sidebar-link">搜索引擎</a></li><li><a href="/m/设计模式/feed流.html" class="sidebar-link">feed流</a></li><li><a href="/m/设计模式/PHP.html" class="sidebar-link">PHP</a></li><li><a href="/m/设计模式/Rust.html" class="sidebar-link">Rust</a></li><li><a href="/m/设计模式/WebSocket.html" class="sidebar-link">Websocket</a></li><li><a href="/m/设计模式/注册中心.html" class="sidebar-link">注册中心</a></li><li><a href="/m/设计模式/web.html" class="sidebar-link">HTTPS</a></li><li><a href="/m/设计模式/k8s.html" class="sidebar-link">k8s</a></li><li><a href="/m/设计模式/vue.html" class="sidebar-link">vue</a></li><li><a href="/m/设计模式/lua.html" class="sidebar-link">lua</a></li><li><a href="/m/设计模式/leader.html" class="sidebar-link">leader</a></li><li><a href="/m/设计模式/热门搜索字符串.html" class="sidebar-link">热门搜索字符串</a></li><li><a href="/m/设计模式/延时消息.html" class="sidebar-link">延时消息</a></li><li><a href="/m/设计模式/分布式事务.html" class="sidebar-link">分布式事务</a></li><li><a href="/m/设计模式/再谈架构.html" class="sidebar-link">再谈架构</a></li><li><a href="/m/设计模式/日志监控.html" class="sidebar-link">日志监控</a></li><li><a href="/m/设计模式/权限系统.html" class="sidebar-link">权限系统</a></li><li><a href="/m/设计模式/消息队列.html" class="sidebar-link">消息队列</a></li><li><a href="/m/设计模式/点赞签到.html" class="sidebar-link">点赞签到</a></li><li><a href="/m/设计模式/用户排名.html" class="sidebar-link">用户排名</a></li><li><a href="/m/设计模式/电商系统.html" class="sidebar-link">电商系统</a></li><li><a href="/m/设计模式/直播.html" class="sidebar-link">直播</a></li><li><a href="/m/设计模式/秒杀抢购.html" class="sidebar-link">秒杀抢购</a></li><li><a href="/m/设计模式/设计模式.html" class="sidebar-link">设计模式</a></li><li><a href="/m/设计模式/通用型系统设计.html" class="sidebar-link">通用型系统设计</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>鸡汤软文</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="分库分表"><a href="#分库分表" class="header-anchor">#</a> 分库分表</h1> <h2 id="部署"><a href="#部署" class="header-anchor">#</a> 部署</h2> <ol><li>主备 : 主提供读写,备冗余做故障转移</li> <li>双主 : 两个主库同时提供服务,负载均衡</li> <li>主从 : 一主多从,读写分离</li> <li>双主双从,多主多从,高可用,可扩展,读写分离</li></ol> <h4 id="一致性问题"><a href="#一致性问题" class="header-anchor">#</a> 一致性问题</h4> <ol><li>主从同步一致性问题 : 忽略、强制读主、写时放入 cache + 过期时间(大于主从延时),读的时候先读缓存再读从库、半同步复制,等待从库完成同步,写请求时间会延长,吞吐量下降</li> <li>cache 与 DB 一致性问题</li></ol> <h2 id="单个非主键查询"><a href="#单个非主键查询" class="header-anchor">#</a> 单个非主键查询</h2> <h3 id="映射法"><a href="#映射法" class="header-anchor">#</a> 映射法</h3> <p><img src="/m/assets/img/yingshefa1.bff3d88d.png" alt="yingshefa1"></p> <h3 id="基因法"><a href="#基因法" class="header-anchor">#</a> 基因法</h3> <p><img src="/m/assets/img/jiyinfa1.40e6f06e.png" alt="jiyinfa1"></p> <p>写入时基因法生成 user_id ,如果分 8 张表, 2 的 3 次方是 8 ,取 3 bit 基因,根据 user_id 查询时可以直接路由到对应分库分表,根据 user_name 查询时先通过 user_name_code 生成函数生成,再取模路由到分库分表.</p> <h2 id="多个非主键查询"><a href="#多个非主键查询" class="header-anchor">#</a> 多个非主键查询</h2> <h3 id="映射法-2"><a href="#映射法-2" class="header-anchor">#</a> 映射法</h3> <p><img src="/m/assets/img/yingshefa2.bd871010.png" alt="yingshefa2"></p> <h3 id="冗余法"><a href="#冗余法" class="header-anchor">#</a> 冗余法</h3> <p><img src="/m/assets/img/rongyufa.ba0ed371.png" alt="rongyufa"></p> <p>按照 order_id 或 buyer_id 查询时路由到 db_o_buyer 库,按照 seller_id 查询时路由到 db_o_seller 库中.</p> <p><img src="/m/assets/img/fenkufenbiao-rongyu.026492b4.png" alt="fenkufenbiao-rongyu"></p> <ol><li>当有订单生成时通过 buyer_uid 分库, oid 中融入分库基因,写入 DB-byer_id 库</li> <li>通过线下一步方式(binglog + cannal),将数据冗余到 DB-seller 库</li> <li>buyer 库通过 buyer_id 分库, seller 库通过 seller_uid 分库,前者满足 oid 和 buyer_uid 查询,后者满足 seller_uid 查询</li></ol> <h3 id="基因法-2"><a href="#基因法-2" class="header-anchor">#</a> 基因法</h3> <p><img src="/m/assets/img/jiyinfa.65ee3a3b.png" alt="jiyinfa"></p> <ol><li>使用 buyer_uid%16 进行分库,决定这行数据插入到哪个库</li> <li>分库基因是 buyer_uid 的最后 4 个 bit,即 1010</li> <li>生成订单 oid 时先使用分布式 ID 生成前 60 位</li> <li>将分库基因 加入到 oid 最后 4 bit 拼装成最终 64bit 订单的 oid,同一个用户下的宿友订单 oid 会落在同一个库上</li> <li>buyer_id % 16 和 oid % 16 都能定位到库</li></ol> <h2 id="其他聚合查询"><a href="#其他聚合查询" class="header-anchor">#</a> 其他聚合查询</h2> <p>ES等noSQL</p> <h2 id="跨库跨表分页查询"><a href="#跨库跨表分页查询" class="header-anchor">#</a> 跨库跨表分页查询</h2> <p>ES等noSQL</p> <h2 id="水平扩容"><a href="#水平扩容" class="header-anchor">#</a> 水平扩容</h2> <h3 id="升级从库法-扩容是成倍的"><a href="#升级从库法-扩容是成倍的" class="header-anchor">#</a> 升级从库法--扩容是成倍的</h3> <p><img src="/m/assets/img/shengjicongkufa.2ae26877.jpeg" alt="shengjicongkufa"></p> <h3 id="双写迁移法-通用方案"><a href="#双写迁移法-通用方案" class="header-anchor">#</a> 双写迁移法--通用方案</h3> <p><img src="data:image/png;base64,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" alt="shuangxieqianyi"></p> <ol><li>修改应用配置和代码,加上双写,部署</li> <li>将老库中的老数据复制到新库</li> <li>以老库为准校对新库中的老数据</li> <li>修改应用配置和代码,去掉双写,部署</li></ol> <h2 id="分库分表问题"><a href="#分库分表问题" class="header-anchor">#</a> 分库分表问题</h2> <h3 id="分布式事务"><a href="#分布式事务" class="header-anchor">#</a> 分布式事务</h3> <h3 id="分页、排序、跨库联合查询"><a href="#分页、排序、跨库联合查询" class="header-anchor">#</a> 分页、排序、跨库联合查询</h3> <h3 id="分布式主键"><a href="#分布式主键" class="header-anchor">#</a> 分布式主键</h3> <h3 id="读写分离"><a href="#读写分离" class="header-anchor">#</a> 读写分离</h3> <h3 id="数据脱敏"><a href="#数据脱敏" class="header-anchor">#</a> 数据脱敏</h3> <h2 id="分库分表工具"><a href="#分库分表工具" class="header-anchor">#</a> 分库分表工具</h2> <h2 id="主键"><a href="#主键" class="header-anchor">#</a> 主键</h2> <ol><li>设定步长</li> <li>分布式 ID</li> <li>不使用主键作为查询依据,每张表新增一个字段作为唯一主键</li></ol> <h3 id="多对多场景-friend-uid1-uid2"><a href="#多对多场景-friend-uid1-uid2" class="header-anchor">#</a> 多对多场景(friend(uid1,uid2))</h3> <p>数据冗余满足不同维度的查询.</p> <ol><li>服务同步冗余(服务层解决),单个请求时间过长</li> <li>服务异步冗余(服务层消息队列)</li> <li>线下异步冗余(db层,binlog同步,常用)</li></ol> <h4 id="一致性问题-2"><a href="#一致性问题-2" class="header-anchor">#</a> 一致性问题</h4> <h3 id="多-key-场景"><a href="#多-key-场景" class="header-anchor">#</a> 多 key 场景</h3> <p>订单中心:订单ID,buyer_id(买家查),seller_id(卖家查)</p> <p>解决方法: order_id 和 buyer_id 基因法,seller_id 做数据冗余.</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新:</span> <span class="time">1/14/2021, 11:57:24 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/m/算法/颠倒二进制位.html" class="prev">
        颠倒二进制位
      </a></span> <span class="next"><a href="/m/设计模式/ES.html">
        ES
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/m/assets/js/app.71fdaff2.js" defer></script><script src="/m/assets/js/2.351ead77.js" defer></script><script src="/m/assets/js/4.b9f14f77.js" defer></script>
  </body>
</html>
