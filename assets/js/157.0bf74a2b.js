(window.webpackJsonp=window.webpackJsonp||[]).push([[157],{715:function(s,a,t){"use strict";t.r(a);var n=t(20),r=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"awk"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#awk"}},[s._v("#")]),s._v(" awk")]),s._v(" "),t("h3",{attrs:{id:"语言结构"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#语言结构"}},[s._v("#")]),s._v(" 语言结构")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'BEGIN {...} pattern { command } END {...}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 脚本通常放在单引号或双引号中")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'BEGIN{ i = 0 } { i++ } END { print i }'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"BEGIN{ i = 0 } { i++ } END { print i }"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 模式时0后面的动作不执行,!0后面的动作才执行")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"执行流程"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#执行流程"}},[s._v("#")]),s._v(" 执行流程")]),s._v(" "),t("ol",[t("li",[s._v("执行GEGIN")]),s._v(" "),t("li",[s._v("一行一行读取文件内容执行pattern,如果只有pattern,会有默认命令{print $0}")]),s._v(" "),t("li",[s._v("执行END")])]),s._v(" "),t("h3",{attrs:{id:"常用参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常用参数"}},[s._v("#")]),s._v(" 常用参数")]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'[#$]'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NF")]),s._v("}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"begin模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#begin模块"}},[s._v("#")]),s._v(" BEGIN模块")]),s._v(" "),t("p",[s._v("在awk读取文件之前,常常用来修改内置变量.有BEGIN可以不需要文件名.")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'BEGIN { RS = "#" } { print '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v(" }'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改内置变量")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'BEGIN { print "-------"} { print '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v(" }'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印分隔行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'BEGIN { a = 8 ; b = 90 ; print a+b , a-b , a/b , a%b }'")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 变量初始化")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"end模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#end模块"}},[s._v("#")]),s._v(" END模块")]),s._v(" "),t("p",[s._v("在文件读取完之后,一般用来输出结果.")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/^$/'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" -l "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# awk 统计空行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/^$/ {i=i+1} END {print i}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出结果")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sed grep 统计空行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'^$'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" -l "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# grep 统计空行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/^$/p'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wc")]),s._v(" -l "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sed 统计空行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("seq")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{ i=i+"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v(" } END {print i}'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"数组"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#数组"}},[s._v("#")]),s._v(" 数组")]),s._v(" "),t("p",[s._v("索引数组和关联数组.")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'BEGIN { arr[0] = 1 ; arr[1] = 2 ; print arr[0] , arr[1] }'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'BEGIN { arr[0] = 1 ; arr[1] = 2 ; for (i in arr) print arr[i] }'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{ a["),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("] = a["),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("] = "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v(" } END { for (i in a) print i , a[i] }'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("seq")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{a[NR]="),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("} END {for (i=1;i<NR-3;i++) { print a[i] } }'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"去重"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#去重"}},[s._v("#")]),s._v(" 去重")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# a++ 和 ++a")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'BEGIN {print a++}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'BEGIN {print ++a}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'BEGIN {a=1;b=a++;print a,b}'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'BEGIN {a=1;b=++a;print a,b}'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 去重")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'!a["),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$n")]),s._v("]++'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此方法去重显示文件开头开始的不重复的行 !a[$n]=a[$n] + 1 {print $0}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'++a["),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$n")]),s._v("]==1'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此方法显示文件开头不重复的行 a[$n]=a[$n]+1 == 1 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'a["),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$n")]),s._v("]="),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v(" END { for( i in a ){print a[i]}}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示文件结尾不重复的行")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h3",{attrs:{id:"统计访问数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#统计访问数"}},[s._v("#")]),s._v(" 统计访问数")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"[/]+"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{ h{"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$n")]),s._v("}++ } END { for (i in h) print i , h[i] }'")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"合并文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#合并文件"}},[s._v("#")]),s._v(" 合并文件")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'NR == FNR { a[FNR] = "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v(" } NR != FNR { print a[NR], "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v(' } > "file3" \'')]),s._v(" file1 file2 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重定向时文件名用双引号")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#函数"}},[s._v("#")]),s._v(" 函数")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{ sub(/A/, "a") ; print '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v(" }'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只替换第一个匹配,相当于sed 's###'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{ gsub(/A/, "a") ; print '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v(" }'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 替换所有匹配,相当于sed 's###g'")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{ sub(/A/, "a", '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v(") ; print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v(" }'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'|'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'BEGIN { OFS = "|" } {sub(/[0-9]+/, "", '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v(") ; print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("}'")]),s._v(" \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'|'")]),s._v(" -v "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("OFS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'|'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{sub(/[0-9]+/, "", '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v(") ; print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"条件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#条件"}},[s._v("#")]),s._v(" 条件")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{ if ("),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("~/AA/) { print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v('" YES" } else { print '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v('" NO"} }\'')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("~/AA/ { print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v('" YES" } '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("!~/AA/ {print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v('" NO" }\'')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'NR==1 || "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v(' =="tcp" && '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$2")]),s._v(" > 0'")]),s._v(" netstat.txt "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 与或运算")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"next用法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#next用法"}},[s._v("#")]),s._v(" next用法")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("~/aa/ { print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v('" YES" ; next}{print '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v('" NO"}\'')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 匹配不执行,不匹配执行next后的代码")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"内置变量"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#内置变量"}},[s._v("#")]),s._v(" 内置变量")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("变量")]),s._v(" "),t("th",[s._v("含义")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("NF")]),s._v(" "),t("td",[s._v("字段个数")])]),s._v(" "),t("tr",[t("td",[s._v("NR")]),s._v(" "),t("td",[s._v("行号")])]),s._v(" "),t("tr",[t("td",[s._v("FS")]),s._v(" "),t("td",[s._v("分隔符")])]),s._v(" "),t("tr",[t("td",[s._v("RS")]),s._v(" "),t("td",[s._v("记录分隔符")])]),s._v(" "),t("tr",[t("td",[s._v("FNR")]),s._v(" "),t("td",[s._v("当前文件行号,每个文件单独计算")])]),s._v(" "),t("tr",[t("td",[s._v("FILENAME")]),s._v(" "),t("td",[s._v("当前文件的文件名")])])])]),s._v(" "),t("h3",{attrs:{id:"正则表达式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#正则表达式"}},[s._v("#")]),s._v(" 正则表达式")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("正则表达式操作符")]),s._v(" "),t("th")])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("~")]),s._v(" "),t("td",[s._v("记录或区域的表达式进行匹配")])]),s._v(" "),t("tr",[t("td",[s._v("!~")]),s._v(" "),t("td",[s._v("表达不匹配")])])])]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("元字符")]),s._v(" "),t("th",[s._v("功能")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("^")]),s._v(" "),t("td",[s._v("开头")])]),s._v(" "),t("tr",[t("td",[s._v("$")]),s._v(" "),t("td",[s._v("结尾")])]),s._v(" "),t("tr",[t("td",[s._v(".")]),s._v(" "),t("td",[s._v("任意单字符")])]),s._v(" "),t("tr",[t("td",[s._v("*")]),s._v(" "),t("td",[s._v("重复前一个字符0次或n次")])]),s._v(" "),t("tr",[t("td",[s._v("+")]),s._v(" "),t("td",[s._v("重复前一个字符0次或n次")])]),s._v(" "),t("tr",[t("td",[s._v("?")]),s._v(" "),t("td",[s._v("重复前一个字符0次或1次")])]),s._v(" "),t("tr",[t("td",[s._v("[]")]),s._v(" "),t("td",[s._v("匹配字符组内任意一个字符")])]),s._v(" "),t("tr",[t("td",[s._v("[^]")]),s._v(" "),t("td",[s._v("匹配不在字符组内的任意字符")])]),s._v(" "),t("tr",[t("td",[s._v("()")]),s._v(" "),t("td",[s._v("子表达式组合")])]),s._v(" "),t("tr",[t("td",[s._v("|")]),s._v(" "),t("td",[s._v("或者")])]),s._v(" "),t("tr",[t("td",[s._v("{m}")]),s._v(" "),t("td",[s._v("重复m次")])]),s._v(" "),t("tr",[t("td",[s._v("{m,}")]),s._v(" "),t("td",[s._v("至少重复m次")])]),s._v(" "),t("tr",[t("td",[s._v("{m,n}")]),s._v(" "),t("td",[s._v("重复m次不超过n次")])])])]),s._v(" "),t("h3",{attrs:{id:"案例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#案例"}},[s._v("#")]),s._v(" 案例")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat t")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'NR == 1 {print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 既有 pattern 又有command")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'NR == 1'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只有pattern,默认print $0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只有command,默认所有行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" -F "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'#'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'NF ==1 {print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("} NF == 3 { print "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("NF-1"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 有多个pattern")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# FNR 和 NR 类似, FNR 多个文件记录不递增,每个都从0开始")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 正则案例")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/321/{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("~/^B/{print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("}"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NF")]),s._v("~/1$/'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 匹配第一列B开头和最后一列1结尾的行,多个模式时默认或关系")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("~/^B|^C/ print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 匹配第一列B或C开头的行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("~/^[BC]/ print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 匹配第一列B或C开头的行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("~/^(B|C)/ print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 匹配第一列B或C开头的行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/ABC/,/CBA/ print "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$0")]),s._v("'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 多个模式用逗号分隔")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("netstat")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/^tcp/ {++S["),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NF")]),s._v("]} END { for (a in S ) print a, s[a]}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 统计 tcp 各连接数量")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{uv["),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$1")]),s._v("]++;next}END{for (ip in uv) print ip,uv[ip]}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# next 关键字跳转到下一行,把下一行作为输入")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'{print substr("),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$4")]),s._v(", 2,11)}'")]),s._v(" log.log "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# substr 字符串截取")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);